import { Component, OnInit, Input, Output, EventEmitter, HostListener } from '@angular/core';
import { Http, Response } from '@angular/http';


@Component({
  selector: 'app-file-upload',
  templateUrl: './file-upload.component.html',
  styleUrls: ['./file-upload.component.css']
})
export class FileUploadComponent implements OnInit {
 data:any[];
loading:boolean;
 uploadURL: string ='http://localhost:3000/upload';


  constructor(private http: Http) {
  this.loading=true; }

  ngOnInit() {
  
  }

  selectedFile: Array<File> = [];  

  onFileChanged(fileInput: any) {
  this.loading=false;
    this.selectedFile =  <Array<File>>fileInput.target.files;
  }

  onUpload() {

     const formData: any = new FormData();
    const files: Array<File> = this.selectedFile;
    formData.append("uploads[]", files[0], files[0]['name']);

    this.http.post(this.uploadURL, formData).map((res: Response) => res.json()).subscribe(
      // map the success function and alert the response
      (success) => {
   this.loading=true;
        console.log("success");
      },
      (error) => console.log("error"));
     }
}